{
  "version": 3,
  "sources": ["../../../../../apps/smart_pos/smart_pos/public/js/smart_pos.bundle.js"],
  "sourcesContent": ["/**\n * Smart POS - Main Bundle\n * Initializes PWA and Service Worker\n */\n\n(function() {\n    'use strict';\n    \n    // Register Service Worker\n    if ('serviceWorker' in navigator) {\n        window.addEventListener('load', () => {\n            navigator.serviceWorker.register('/assets/smart_pos/js/service-worker.js')\n                .then(registration => {\n                    console.log('Smart POS SW registered:', registration.scope);\n                    \n                    // Check for updates periodically\n                    setInterval(() => {\n                        registration.update();\n                    }, 60000); // Every minute\n                    \n                    // Handle updates\n                    registration.addEventListener('updatefound', () => {\n                        const newWorker = registration.installing;\n                        newWorker.addEventListener('statechange', () => {\n                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                                // New version available\n                                showUpdateNotification();\n                            }\n                        });\n                    });\n                })\n                .catch(error => {\n                    console.error('Smart POS SW registration failed:', error);\n                });\n        });\n    }\n    \n    // Show update notification\n    function showUpdateNotification() {\n        if (window.frappe && frappe.show_alert) {\n            frappe.show_alert({\n                message: 'A new version of Smart POS is available. <a href=\"#\" onclick=\"window.location.reload()\">Refresh</a>',\n                indicator: 'blue'\n            }, 10);\n        }\n    }\n    \n    // PWA Install Prompt\n    let deferredPrompt;\n    \n    window.addEventListener('beforeinstallprompt', (e) => {\n        e.preventDefault();\n        deferredPrompt = e;\n        \n        // Show install button if on POS page\n        setTimeout(() => {\n            if (window.location.pathname.includes('pos-terminal')) {\n                showInstallPrompt();\n            }\n        }, 5000);\n    });\n    \n    function showInstallPrompt() {\n        if (!deferredPrompt) return;\n        \n        if (window.frappe && frappe.show_alert) {\n            frappe.show_alert({\n                message: 'Install Smart POS for offline access. <a href=\"#\" id=\"pwa-install-btn\">Install</a>',\n                indicator: 'blue'\n            }, 15);\n            \n            $('#pwa-install-btn').on('click', async (e) => {\n                e.preventDefault();\n                await installPWA();\n            });\n        }\n    }\n    \n    async function installPWA() {\n        if (!deferredPrompt) return;\n        \n        deferredPrompt.prompt();\n        const { outcome } = await deferredPrompt.userChoice;\n        \n        if (outcome === 'accepted') {\n            console.log('Smart POS PWA installed');\n        }\n        \n        deferredPrompt = null;\n    }\n    \n    // Expose install function globally\n    window.installSmartPOS = installPWA;\n    \n    // Detect online/offline status\n    window.addEventListener('online', () => {\n        document.body.classList.remove('offline');\n        if (window.frappe && frappe.show_alert) {\n            frappe.show_alert({ message: 'Back online', indicator: 'green' }, 3);\n        }\n    });\n    \n    window.addEventListener('offline', () => {\n        document.body.classList.add('offline');\n        if (window.frappe && frappe.show_alert) {\n            frappe.show_alert({ message: 'You are offline', indicator: 'orange' }, 3);\n        }\n    });\n    \n})();\n"],
  "mappings": ";;AAKA,GAAC,WAAW;AACR;AAGA,QAAI,mBAAmB,WAAW;AAC9B,aAAO,iBAAiB,QAAQ,MAAM;AAClC,kBAAU,cAAc,SAAS,wCAAwC,EACpE,KAAK,kBAAgB;AAClB,kBAAQ,IAAI,4BAA4B,aAAa,KAAK;AAG1D,sBAAY,MAAM;AACd,yBAAa,OAAO;AAAA,UACxB,GAAG,GAAK;AAGR,uBAAa,iBAAiB,eAAe,MAAM;AAC/C,kBAAM,YAAY,aAAa;AAC/B,sBAAU,iBAAiB,eAAe,MAAM;AAC5C,kBAAI,UAAU,UAAU,eAAe,UAAU,cAAc,YAAY;AAEvE,uCAAuB;AAAA,cAC3B;AAAA,YACJ,CAAC;AAAA,UACL,CAAC;AAAA,QACL,CAAC,EACA,MAAM,WAAS;AACZ,kBAAQ,MAAM,qCAAqC,KAAK;AAAA,QAC5D,CAAC;AAAA,MACT,CAAC;AAAA,IACL;AAGA,aAAS,yBAAyB;AAC9B,UAAI,OAAO,UAAU,OAAO,YAAY;AACpC,eAAO,WAAW;AAAA,UACd,SAAS;AAAA,UACT,WAAW;AAAA,QACf,GAAG,EAAE;AAAA,MACT;AAAA,IACJ;AAGA,QAAI;AAEJ,WAAO,iBAAiB,uBAAuB,CAAC,MAAM;AAClD,QAAE,eAAe;AACjB,uBAAiB;AAGjB,iBAAW,MAAM;AACb,YAAI,OAAO,SAAS,SAAS,SAAS,cAAc,GAAG;AACnD,4BAAkB;AAAA,QACtB;AAAA,MACJ,GAAG,GAAI;AAAA,IACX,CAAC;AAED,aAAS,oBAAoB;AACzB,UAAI,CAAC;AAAgB;AAErB,UAAI,OAAO,UAAU,OAAO,YAAY;AACpC,eAAO,WAAW;AAAA,UACd,SAAS;AAAA,UACT,WAAW;AAAA,QACf,GAAG,EAAE;AAEL,UAAE,kBAAkB,EAAE,GAAG,SAAS,OAAO,MAAM;AAC3C,YAAE,eAAe;AACjB,gBAAM,WAAW;AAAA,QACrB,CAAC;AAAA,MACL;AAAA,IACJ;AAEA,mBAAe,aAAa;AACxB,UAAI,CAAC;AAAgB;AAErB,qBAAe,OAAO;AACtB,YAAM,EAAE,QAAQ,IAAI,MAAM,eAAe;AAEzC,UAAI,YAAY,YAAY;AACxB,gBAAQ,IAAI,yBAAyB;AAAA,MACzC;AAEA,uBAAiB;AAAA,IACrB;AAGA,WAAO,kBAAkB;AAGzB,WAAO,iBAAiB,UAAU,MAAM;AACpC,eAAS,KAAK,UAAU,OAAO,SAAS;AACxC,UAAI,OAAO,UAAU,OAAO,YAAY;AACpC,eAAO,WAAW,EAAE,SAAS,eAAe,WAAW,QAAQ,GAAG,CAAC;AAAA,MACvE;AAAA,IACJ,CAAC;AAED,WAAO,iBAAiB,WAAW,MAAM;AACrC,eAAS,KAAK,UAAU,IAAI,SAAS;AACrC,UAAI,OAAO,UAAU,OAAO,YAAY;AACpC,eAAO,WAAW,EAAE,SAAS,mBAAmB,WAAW,SAAS,GAAG,CAAC;AAAA,MAC5E;AAAA,IACJ,CAAC;AAAA,EAEL,GAAG;",
  "names": []
}
